<!doctype html>
<html âš¡>
<head>
  <meta charset="utf-8">
  <title>My AMP Page</title>
  <link rel="canonical" href="self.html" />
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src="https://cdn.ampproject.org/v0.js"></script>
  <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  <script async custom-element="amp-script" src="https://cdn.ampproject.org/v0/amp-script-0.1.js"></script>
  <style amp-custom>
    h1 {
      margin: 1rem;
    }
    p {
      width: 600px;
      margin-bottom: 1em;
      display: block;
      font-size: 1.4em;
    }
    html, body {
      width: 100%;
      min-height: 100%;
      height: 100%;
    }    
    div {
      width: 600px;
      margin: 2em auto;
    }
    span {
      color: blue;
      text-decoration: underline;
    }
    amp-iframe, iframe {
      margin-top: 2000px;
    }
  </style>
  
  <meta
    name="amp-script-src"
    content="sha384-jgUAHmUtpBaPLkLtDNc5WRhC382uZ2XyY-58IFiCW7shl2lbpVn3cUV-kIlz6Pyr"
  />
</head>

<body>
  <amp-script layout="fixed" width="600" height="800" script="navigate-to-subpage">    
    <div id="page">
      <strong>This is original page!</strong>
      <span id="navigate">Navigate to subpage</span>
    </div>
    <amp-iframe
      layout="responsive"
      width="500"
      height="100"
      sandbox="allow-scripts allow-same-origin"
      src="https://boring-bohr-f491bc.netlify.app/redirect">      
    </amp-iframe>
  </amp-script>
  
  <!-- Add [target="amp-script"] to the <script> element. -->
  <script id="navigate-to-subpage" type="text/plain" target="amp-script">
    const link = document.getElementById('navigate');
    const page = document.getElementById('page');
    let currentUrl = '';

    link.addEventListener('click', () => {
      page.innerHTML = '<strong>This is a subpage</strong>';
    } );

    window.addEventListener('popstate', ( e ) => {            
      const currenturl = window.localStorage.getItem( 'currenturl' );
      page.innerHTML = window.localStorage.getItem( currenturl );
    } );
  </script>
</body>
</html>
